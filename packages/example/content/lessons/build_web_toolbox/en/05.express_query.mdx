---
title: å¿«é€’æŸ¥è¯¢åŠŸèƒ½å®ç°
description: å®ç°å¿«é€’æŸ¥è¯¢é¡µé¢ã€å¿«é€’ä¿¡æ¯å±•ç¤ºç»„ä»¶å’ŒæŸ¥è¯¢å†å²è®°å½•åŠŸèƒ½
---

åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å®ç°ä¸€ä¸ªå®Œæ•´çš„å¿«é€’æŸ¥è¯¢åŠŸèƒ½ã€‚ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š

1. è®¾è®¡å’Œå®ç°å¿«é€’æŸ¥è¯¢é¡µé¢
2. åˆ›å»ºå¿«é€’ä¿¡æ¯å±•ç¤ºç»„ä»¶
3. é›†æˆèšåˆæ•°æ®å¿«é€’ API
4. å®ç°æŸ¥è¯¢å†å²è®°å½•åŠŸèƒ½

## å‡†å¤‡å·¥ä½œ

1. æ³¨å†Œèšåˆæ•°æ®è´¦å·å¹¶è·å– API Keyï¼š
   - è®¿é—® [èšåˆæ•°æ®å®˜ç½‘](https://www.juhe.cn/)
   - æ³¨å†Œè´¦å·å¹¶å®åè®¤è¯
   - ç”³è¯·å…¨å›½å¿«é€’ç‰©æµæŸ¥è¯¢ API
   - è·å– API Key

2. æ›´æ–°ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š

```bash
# .env
JUHE_EXPRESS_KEY=your_api_key_here
```

## å¿«é€’ä¿¡æ¯å±•ç¤ºç»„ä»¶

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯å¤ç”¨çš„å¿«é€’ä¿¡æ¯å±•ç¤ºç»„ä»¶ï¼š

```vue
<!-- components/ExpressCard.vue -->
<script setup lang="ts">
import { computed } from 'vue'

// å®šä¹‰ç»„ä»¶å±æ€§
interface Props {
  info: {
    company: string
    number: string
    list: Array<{
      datetime: string
      remark: string
      zone: string
    }>
    status: string
    isComplete: boolean
  }
}

const props = defineProps<Props>()

// æ ¹æ®å¿«é€’çŠ¶æ€é€‰æ‹©å›¾æ ‡å’Œé¢œè‰²
const statusInfo = computed(() => {
  const status = props.info.status
  if (status === 'å·²ç­¾æ”¶') {
    return {
      icon: 'âœ…',
      color: 'text-success'
    }
  }
  if (status === 'è¿è¾“ä¸­') {
    return {
      icon: 'ğŸšš',
      color: 'text-info'
    }
  }
  return {
    icon: 'ğŸ“¦',
    color: 'text-warning'
  }
})
</script>

<template>
  <div class="card w-full bg-base-200 shadow-xl">
    <div class="card-body">
      <h2 class="card-title text-2xl flex justify-between">
        <span>{{ info.company }}</span>
        <span :class="statusInfo.color">
          {{ statusInfo.icon }} {{ info.status }}
        </span>
      </h2>
      <p class="text-lg mb-4">è¿å•å·ï¼š{{ info.number }}</p>
      
      <!-- ç‰©æµä¿¡æ¯æ—¶é—´çº¿ -->
      <ul class="timeline timeline-vertical">
        <li v-for="(item, index) in info.list" :key="index" class="timeline-item">
          <div class="timeline-middle">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" />
            </svg>
          </div>
          <div class="timeline-start md:text-end mb-10">
            <time class="font-mono">{{ item.datetime }}</time>
            <div class="text-lg">{{ item.remark }}</div>
            <div class="text-sm text-base-content/60">{{ item.zone }}</div>
          </div>
          <hr/>
        </li>
      </ul>
    </div>
  </div>
</template>
```

## å¿«é€’æŸ¥è¯¢é¡µé¢

æ¥ä¸‹æ¥ï¼Œåˆ›å»ºå¿«é€’æŸ¥è¯¢é¡µé¢ï¼š

```vue
<!-- pages/express/index.vue -->
<script setup lang="ts">
import { ref, onMounted } from 'vue'

// æŸ¥è¯¢è¡¨å•
const company = ref('')
const number = ref('')
const loading = ref(false)
const error = ref('')

// å¿«é€’ä¿¡æ¯
const expressInfo = ref<any>(null)

// æŸ¥è¯¢å†å²
const history = ref<Array<{
  company: string
  number: string
  time: string
}>>([])

// å¿«é€’å…¬å¸åˆ—è¡¨
const companies = [
  { name: 'é¡ºä¸°é€Ÿè¿', code: 'SF' },
  { name: 'ä¸­é€šå¿«é€’', code: 'ZTO' },
  { name: 'åœ†é€šé€Ÿé€’', code: 'YTO' },
  { name: 'éŸµè¾¾é€Ÿé€’', code: 'YD' },
  { name: 'ç”³é€šå¿«é€’', code: 'STO' },
  { name: 'ç™¾ä¸–å¿«é€’', code: 'HTKY' },
  { name: 'EMS', code: 'EMS' },
  { name: 'äº¬ä¸œç‰©æµ', code: 'JD' }
]

// åŠ è½½æŸ¥è¯¢å†å²
onMounted(() => {
  const savedHistory = localStorage.getItem('express_history')
  if (savedHistory) {
    history.value = JSON.parse(savedHistory)
  }
})

// ä¿å­˜æŸ¥è¯¢å†å²
function saveHistory(companyName: string, expressNumber: string) {
  const newRecord = {
    company: companyName,
    number: expressNumber,
    time: new Date().toLocaleString('zh-CN')
  }
  
  history.value = [newRecord, ...history.value.slice(0, 9)]
  localStorage.setItem('express_history', JSON.stringify(history.value))
}

// æŸ¥è¯¢å¿«é€’ä¿¡æ¯
async function queryExpress() {
  if (!company.value || !number.value) {
    error.value = 'è¯·é€‰æ‹©å¿«é€’å…¬å¸å¹¶è¾“å…¥è¿å•å·'
    return
  }
  
  try {
    loading.value = true
    error.value = ''
    expressInfo.value = null
    
    // è°ƒç”¨å¿«é€’æŸ¥è¯¢ API
    const response = await fetch('/api/express/query', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        company: company.value,
        number: number.value
      })
    })
    
    const data = await response.json()
    
    if (data.error) {
      error.value = data.error
      return
    }
    
    expressInfo.value = data
    const companyName = companies.find(c => c.code === company.value)?.name || company.value
    saveHistory(companyName, number.value)
  } catch (e) {
    error.value = 'æŸ¥è¯¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'
  } finally {
    loading.value = false
  }
}

// ä»å†å²è®°å½•ä¸­æŸ¥è¯¢
function queryFromHistory(record: typeof history.value[0]) {
  company.value = companies.find(c => c.name === record.company)?.code || ''
  number.value = record.number
  queryExpress()
}

// æ¸…ç©ºå†å²è®°å½•
function clearHistory() {
  history.value = []
  localStorage.removeItem('express_history')
}
</script>

<template>
  <div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-8">å¿«é€’æŸ¥è¯¢</h1>
    
    <!-- æŸ¥è¯¢è¡¨å• -->
    <div class="form-control w-full max-w-lg mb-8">
      <div class="flex gap-4 mb-4">
        <select
          v-model="company"
          class="select select-bordered w-full max-w-xs"
        >
          <option value="">é€‰æ‹©å¿«é€’å…¬å¸</option>
          <option
            v-for="item in companies"
            :key="item.code"
            :value="item.code"
          >
            {{ item.name }}
          </option>
        </select>
        
        <input
          v-model="number"
          type="text"
          placeholder="è¾“å…¥è¿å•å·"
          class="input input-bordered w-full"
        />
      </div>
      
      <button
        class="btn btn-primary w-full"
        :disabled="loading"
        @click="queryExpress"
      >
        æŸ¥è¯¢
      </button>
      
      <!-- é”™è¯¯æç¤º -->
      <div v-if="error" class="alert alert-error mt-4">
        {{ error }}
      </div>
    </div>
    
    <!-- æŸ¥è¯¢å†å² -->
    <div v-if="history.length > 0" class="mb-8">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold">æŸ¥è¯¢å†å²</h2>
        <button
          class="btn btn-sm btn-ghost"
          @click="clearHistory"
        >
          æ¸…ç©º
        </button>
      </div>
      
      <div class="overflow-x-auto">
        <table class="table table-zebra">
          <thead>
            <tr>
              <th>å¿«é€’å…¬å¸</th>
              <th>è¿å•å·</th>
              <th>æŸ¥è¯¢æ—¶é—´</th>
              <th>æ“ä½œ</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="record in history" :key="record.number">
              <td>{{ record.company }}</td>
              <td>{{ record.number }}</td>
              <td>{{ record.time }}</td>
              <td>
                <button
                  class="btn btn-sm btn-ghost"
                  @click="queryFromHistory(record)"
                >
                  é‡æ–°æŸ¥è¯¢
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- å¿«é€’ä¿¡æ¯ -->
    <div v-if="expressInfo">
      <ExpressCard :info="expressInfo" />
    </div>
    
    <!-- åŠ è½½çŠ¶æ€ -->
    <div
      v-if="loading"
      class="flex justify-center items-center h-40"
    >
      <span class="loading loading-spinner loading-lg"></span>
    </div>
  </div>
</template>
```

## API è·¯ç”±

åˆ›å»ºå¿«é€’æŸ¥è¯¢ç›¸å…³çš„ API è·¯ç”±ï¼š

```typescript
// server/api/express/query.ts
import { defineEventHandler, readBody } from 'h3'

export default defineEventHandler(async (event) => {
  try {
    const body = await readBody(event)
    const { company, number } = body
    
    if (!company || !number) {
      return {
        error: 'è¯·æä¾›å¿«é€’å…¬å¸å’Œè¿å•å·'
      }
    }
    
    // è°ƒç”¨èšåˆæ•°æ®å¿«é€’ API
    const apiKey = process.env.JUHE_EXPRESS_KEY
    const response = await fetch(
      `http://apis.juhe.cn/exp/index?com=${company}&no=${number}&key=${apiKey}`
    )
    
    const data = await response.json()
    
    if (data.error_code !== 0) {
      return {
        error: data.reason || 'è·å–å¿«é€’ä¿¡æ¯å¤±è´¥'
      }
    }
    
    // æ ¼å¼åŒ–è¿”å›æ•°æ®
    return {
      company: data.result.company,
      number: data.result.no,
      list: data.result.list,
      status: data.result.status,
      isComplete: data.result.isComplete
    }
  } catch (error) {
    console.error('Express API Error:', error)
    return {
      error: 'æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'
    }
  }
})
```

## ä½¿ç”¨è¯´æ˜

1. æŸ¥è¯¢å¿«é€’ä¿¡æ¯ï¼š
   - ä»ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©å¿«é€’å…¬å¸
   - è¾“å…¥è¿å•å·
   - ç‚¹å‡»æŸ¥è¯¢æŒ‰é’®

2. æŸ¥è¯¢å†å²åŠŸèƒ½ï¼š
   - è‡ªåŠ¨ä¿å­˜æœ€è¿‘ 10 æ¡æŸ¥è¯¢è®°å½•
   - æ”¯æŒä»å†å²è®°å½•ä¸­é‡æ–°æŸ¥è¯¢
   - å¯ä»¥æ¸…ç©ºå†å²è®°å½•

3. å¿«é€’ä¿¡æ¯å±•ç¤ºï¼š
   - å¿«é€’å…¬å¸åç§°
   - è¿å•å·
   - ç‰©æµçŠ¶æ€å’Œå›¾æ ‡
   - è¯¦ç»†çš„ç‰©æµä¿¡æ¯æ—¶é—´çº¿

## ä¼˜åŒ–å»ºè®®

1. æ•°æ®éªŒè¯
   - æ·»åŠ è¿å•å·æ ¼å¼éªŒè¯
   - æ”¯æŒæ‰«æè¿å•å·äºŒç»´ç 

2. ç”¨æˆ·ä½“éªŒ
   - æ·»åŠ è¿å•å·è‡ªåŠ¨è¯†åˆ«å¿«é€’å…¬å¸åŠŸèƒ½
   - æ”¯æŒè®¢é˜…ç‰©æµæ›´æ–°æé†’
   - æ·»åŠ å¸¸ç”¨è¿å•å·æ”¶è—åŠŸèƒ½

3. æ€§èƒ½ä¼˜åŒ–
   - å®ç°æŸ¥è¯¢ç»“æœç¼“å­˜
   - ä¼˜åŒ–å†å²è®°å½•å­˜å‚¨æ–¹å¼
   - æ·»åŠ æŸ¥è¯¢é¢‘ç‡é™åˆ¶

## ä¸‹ä¸€æ­¥

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ï¼š

1. å®ç°æ±‡ç‡æ¢ç®—åŠŸèƒ½
2. è®¾è®¡æ±‡ç‡è®¡ç®—å™¨ç•Œé¢
3. é›†æˆæ±‡ç‡æŸ¥è¯¢ API
4. æ·»åŠ è´§å¸é€‰æ‹©åŠŸèƒ½